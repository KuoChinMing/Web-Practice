class Calculator{constructor(e,t){this.previousOperandTextElement=e,this.currentOperandTextElement=t,this.clear()}clear(){this.previousOperand="",this.currentOperand="",this.operator=""}delete(){this.currentOperand=this.currentOperand.toString().slice(0,-1)}compute(){let e;const t=parseFloat(this.previousOperand),r=parseFloat(this.currentOperand);if(!isNaN(t)&&!isNaN(r)){switch(this.operator){case"รท":case"/":e=t/r;break;case"ร":case"*":e=t*r;break;case"+":e=t+r;break;case"-":e=t-r;break;case"%":e=t%r;break;default:return}this.currentOperand=e,this.previousOperand=this.operator=""}}appendNumber(e){"."===e&&this.currentOperand.toString().includes(e)||(this.currentOperand=this.currentOperand.toString()+e.toString())}chooseOperator(e){""!==this.currentOperand?(""!==this.previousOperand&&this.compute(),this.operator=e,this.previousOperand=this.currentOperand,this.currentOperand=""):isNaN(parseFloat(this.previousOperand))||(this.operator=e)}getDisplayNumber(e){const t=e.toString();let r,a=parseFloat(t.split(".")[0]),c=t.split(".")[1];return r=isNaN(a)?"":a.toLocaleString("en",{maximumFractionDigits:0}),null!=c?`${r}.${c}`:r}updateDisplay(){this.currentOperandTextElement.innerText=this.getDisplayNumber(this.currentOperand),this.previousOperandTextElement.innerText=`${this.getDisplayNumber(this.previousOperand)} ${this.operator}`}}const numberButtons=document.querySelectorAll("[data-number]"),operatorButtons=document.querySelectorAll("[data-operator]"),deleteButton=document.querySelector("[data-delete]"),clearButton=document.querySelector("[data-clear]"),equalsButton=document.querySelector("[data-equals]"),previousOperandText=document.querySelector("[data-previous-operand]"),currentOperandText=document.querySelector("[data-current-operand]"),calculator=new Calculator(previousOperandText,currentOperandText);numberButtons.forEach(e=>{e.addEventListener("click",()=>{calculator.appendNumber(e.innerText),calculator.updateDisplay()})}),operatorButtons.forEach(e=>{e.addEventListener("click",()=>{calculator.chooseOperator(e.innerText),calculator.updateDisplay()})}),equalsButton.addEventListener("click",()=>{calculator.compute(),calculator.updateDisplay()}),clearButton.addEventListener("click",()=>{calculator.clear(),calculator.updateDisplay()}),deleteButton.addEventListener("click",()=>{calculator.delete(),calculator.updateDisplay()});const numberArr=["1","2","3","4","5","6","7","8","9","0","."];document.addEventListener("keydown",(function(e){numberArr.includes(e.key)?calculator.appendNumber(e.key):"Backspace"===e.key?calculator.delete():"-"===e.key||"/"===e.key||e.shiftKey&&("+"===e.key||"*"===e.key||"%"===e.key)?calculator.chooseOperator(e.key):"Enter"!==e.key&&"="!==e.key||calculator.compute(),calculator.updateDisplay(),console.log(e)}));const colorThemeSwitch=document.querySelector("#colorTheme"),colorTheme=localStorage.getItem("colorTheme");"dark"===colorTheme?(colorThemeSwitch.checked=!0,document.documentElement.setAttribute("data-theme","dark")):(colorThemeSwitch.checked=!1,document.documentElement.setAttribute("data-theme","light")),colorThemeSwitch.addEventListener("change",(function(){this.checked?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("colorTheme","dark")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("colorTheme","light"))}));
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIkNhbGN1bGF0b3IiLCJbb2JqZWN0IE9iamVjdF0iLCJwcmV2aW91c09wZXJhbmRUZXh0RWxlbWVudCIsImN1cnJlbnRPcGVyYW5kVGV4dEVsZW1lbnQiLCJ0aGlzIiwiY2xlYXIiLCJwcmV2aW91c09wZXJhbmQiLCJjdXJyZW50T3BlcmFuZCIsIm9wZXJhdG9yIiwidG9TdHJpbmciLCJzbGljZSIsInJlc3VsdCIsInByZXYiLCJwYXJzZUZsb2F0IiwiY3VycmVudCIsImlzTmFOIiwibnVtYmVyIiwiaW5jbHVkZXMiLCJjb21wdXRlIiwic3RyaW5nTnVtYmVyIiwiaW50ZWdlckRpc3BsYXkiLCJpbnRlZ2VyRGlnaXRzIiwic3BsaXQiLCJkZWNpbWFsRGlnaXRzIiwidG9Mb2NhbGVTdHJpbmciLCJtYXhpbXVtRnJhY3Rpb25EaWdpdHMiLCJpbm5lclRleHQiLCJnZXREaXNwbGF5TnVtYmVyIiwibnVtYmVyQnV0dG9ucyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsIm9wZXJhdG9yQnV0dG9ucyIsImRlbGV0ZUJ1dHRvbiIsInF1ZXJ5U2VsZWN0b3IiLCJjbGVhckJ1dHRvbiIsImVxdWFsc0J1dHRvbiIsInByZXZpb3VzT3BlcmFuZFRleHQiLCJjdXJyZW50T3BlcmFuZFRleHQiLCJjYWxjdWxhdG9yIiwiZm9yRWFjaCIsImJ1dHRvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJhcHBlbmROdW1iZXIiLCJ1cGRhdGVEaXNwbGF5IiwiY2hvb3NlT3BlcmF0b3IiLCJkZWxldGUiLCJudW1iZXJBcnIiLCJlIiwia2V5Iiwic2hpZnRLZXkiLCJjb25zb2xlIiwibG9nIiwiY29sb3JUaGVtZVN3aXRjaCIsImNvbG9yVGhlbWUiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiY2hlY2tlZCIsImRvY3VtZW50RWxlbWVudCIsInNldEF0dHJpYnV0ZSIsInNldEl0ZW0iXSwibWFwcGluZ3MiOiJBQUNBLE1BQU1BLFdBQ0pDLFlB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QWlCLFdBQVcsU0FBU00sR0FDeENELFVBQVU3QixTQUFTOEIsRUFBRUMsS0FDdkJWLFdBQVdJLGFBQWFLLEVBQUVDLEtBQ1AsY0FBVkQsRUFBRUMsSUFDWFYsV0FBV08sU0FFRCxNQUFWRSxFQUFFQyxLQUNRLE1BQVZELEVBQUVDLEtBQ0RELEVBQUVFLFdBQXVCLE1BQVZGLEVBQUVDLEtBQXlCLE1BQVZELEVBQUVDLEtBQXlCLE1BQVZELEVBQUVDLEtBRXBEVixXQUFXTSxlQUFlRyxFQUFFQyxLQUNULFVBQVZELEVBQUVDLEtBQTZCLE1BQVZELEVBQUVDLEtBQ2hDVixXQUFXcEIsVUFFYm9CLFdBQVdLLGdCQUNYTyxRQUFRQyxJQUFJSixNQUdkLE1BQU1LLGlCQUFtQnZCLFNBQVNJLGNBQWMsZUFDMUNvQixXQUFhQyxhQUFhQyxRQUFRLGNBQ3JCLFNBQWZGLFlBQ0ZELGlCQUFpQkksU0FBVSxFQUMzQjNCLFNBQVM0QixnQkFBZ0JDLGFBQWEsYUFBYyxVQUdwRE4saUJBQWlCSSxTQUFVLEVBQzNCM0IsU0FBUzRCLGdCQUFnQkMsYUFBYSxhQUFjLFVBRXRETixpQkFBaUJYLGlCQUFpQixVQUFVLFdBQ3RDckMsS0FBS29ELFNBQ1AzQixTQUFTNEIsZ0JBQWdCQyxhQUFhLGFBQWMsUUFDcERKLGFBQWFLLFFBQVEsYUFBYyxVQUVuQzlCLFNBQVM0QixnQkFBZ0JDLGFBQWEsYUFBYyxTQUNwREosYUFBYUssUUFBUSxhQUFjIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gdHV0b3JpYWw6IGh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9ajU5cVE3WVdMeHcmbGlzdD1MTEhrRHdHNzBJUGNkSHhVT1FFWGZaTXdcbmNsYXNzIENhbGN1bGF0b3Ige1xuICBjb25zdHJ1Y3RvcihwcmV2aW91c09wZXJhbmRUZXh0RWxlbWVudCwgY3VycmVudE9wZXJhbmRUZXh0RWxlbWVudCkge1xuICAgIHRoaXMucHJldmlvdXNPcGVyYW5kVGV4dEVsZW1lbnQgPSBwcmV2aW91c09wZXJhbmRUZXh0RWxlbWVudDtcbiAgICB0aGlzLmN1cnJlbnRPcGVyYW5kVGV4dEVsZW1lbnQgPSBjdXJyZW50T3BlcmFuZFRleHRFbGVtZW50O1xuICAgIHRoaXMuY2xlYXIoKTtcbiAgfVxuXG4gIGNsZWFyKCkge1xuICAgIHRoaXMucHJldmlvdXNPcGVyYW5kID0gJyc7XG4gICAgdGhpcy5jdXJyZW50T3BlcmFuZCA9ICcnO1xuICAgIHRoaXMub3BlcmF0b3IgPSAnJztcbiAgfVxuXG4gIGRlbGV0ZSgpIHtcbiAgICB0aGlzLmN1cnJlbnRPcGVyYW5kID0gdGhpcy5jdXJyZW50T3BlcmFuZC50b1N0cmluZygpLnNsaWNlKDAsIC0xKTtcbiAgfVxuXG4gIGNvbXB1dGUoKSB7XG4gICAgbGV0IHJlc3VsdDtcbiAgICBjb25zdCBwcmV2ID0gcGFyc2VGbG9hdCh0aGlzLnByZXZpb3VzT3BlcmFuZCk7XG4gICAgY29uc3QgY3VycmVudCA9IHBhcnNlRmxvYXQodGhpcy5jdXJyZW50T3BlcmFuZCk7XG4gICAgaWYgKGlzTmFOKHByZXYpIHx8IGlzTmFOKGN1cnJlbnQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHN3aXRjaCAodGhpcy5vcGVyYXRvcikge1xuICAgICAgY2FzZSAnw7cnOlxuICAgICAgICByZXN1bHQgPSBwcmV2IC8gY3VycmVudDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICcvJzogLy8gZm9yIGtleWJvYXJkXG4gICAgICAgIHJlc3VsdCA9IHByZXYgLyBjdXJyZW50O1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ8OXJzpcbiAgICAgICAgcmVzdWx0ID0gcHJldiAqIGN1cnJlbnQ7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnKic6IC8vIGZvciBrZXlib2FyZFxuICAgICAgICByZXN1bHQgPSBwcmV2ICogY3VycmVudDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICcrJzpcbiAgICAgICAgcmVzdWx0ID0gcHJldiArIGN1cnJlbnQ7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnLSc6XG4gICAgICAgIHJlc3VsdCA9IHByZXYgLSBjdXJyZW50O1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJyUnOlxuICAgICAgICByZXN1bHQgPSBwcmV2ICUgY3VycmVudDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuY3VycmVudE9wZXJhbmQgPSByZXN1bHQ7XG4gICAgdGhpcy5wcmV2aW91c09wZXJhbmQgPSB0aGlzLm9wZXJhdG9yID0gJyc7XG4gIH1cblxuICBhcHBlbmROdW1iZXIobnVtYmVyKSB7XG4gICAgaWYgKG51bWJlciA9PT0gJy4nICYmIHRoaXMuY3VycmVudE9wZXJhbmQudG9TdHJpbmcoKS5pbmNsdWRlcyhudW1iZXIpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuY3VycmVudE9wZXJhbmQgPSB0aGlzLmN1cnJlbnRPcGVyYW5kLnRvU3RyaW5nKCkgKyBudW1iZXIudG9TdHJpbmcoKTtcbiAgfVxuXG4gIGNob29zZU9wZXJhdG9yKG9wZXJhdG9yKSB7XG4gICAgaWYgKHRoaXMuY3VycmVudE9wZXJhbmQgPT09ICcnKSB7XG4gICAgICBpZiAoIWlzTmFOKHBhcnNlRmxvYXQodGhpcy5wcmV2aW91c09wZXJhbmQpKSkge1xuICAgICAgICB0aGlzLm9wZXJhdG9yID0gb3BlcmF0b3I7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0aGlzLnByZXZpb3VzT3BlcmFuZCAhPT0gJycpIHtcbiAgICAgIHRoaXMuY29tcHV0ZSgpO1xuICAgIH1cbiAgICB0aGlzLm9wZXJhdG9yID0gb3BlcmF0b3I7XG4gICAgdGhpcy5wcmV2aW91c09wZXJhbmQgPSB0aGlzLmN1cnJlbnRPcGVyYW5kO1xuICAgIHRoaXMuY3VycmVudE9wZXJhbmQgPSAnJztcbiAgfVxuXG4gIGdldERpc3BsYXlOdW1iZXIobnVtYmVyKSB7XG4gICAgY29uc3Qgc3RyaW5nTnVtYmVyID0gbnVtYmVyLnRvU3RyaW5nKCk7XG4gICAgbGV0IGludGVnZXJEaWdpdHMgPSBwYXJzZUZsb2F0KHN0cmluZ051bWJlci5zcGxpdCgnLicpWzBdKTtcbiAgICBsZXQgZGVjaW1hbERpZ2l0cyA9IHN0cmluZ051bWJlci5zcGxpdCgnLicpWzFdO1xuICAgIGxldCBpbnRlZ2VyRGlzcGxheTtcbiAgICBpZiAoaXNOYU4oaW50ZWdlckRpZ2l0cykpIHtcbiAgICAgIGludGVnZXJEaXNwbGF5ID0gJyc7XG4gICAgfSBlbHNlIHtcbiAgICAgIGludGVnZXJEaXNwbGF5ID0gaW50ZWdlckRpZ2l0cy50b0xvY2FsZVN0cmluZygnZW4nLCB7XG4gICAgICAgIG1heGltdW1GcmFjdGlvbkRpZ2l0czogMCxcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoZGVjaW1hbERpZ2l0cyAhPSBudWxsKSB7XG4gICAgICByZXR1cm4gYCR7aW50ZWdlckRpc3BsYXl9LiR7ZGVjaW1hbERpZ2l0c31gO1xuICAgIH1cbiAgICByZXR1cm4gaW50ZWdlckRpc3BsYXk7XG4gIH1cblxuICB1cGRhdGVEaXNwbGF5KCkge1xuICAgIHRoaXMuY3VycmVudE9wZXJhbmRUZXh0RWxlbWVudC5pbm5lclRleHQgPSB0aGlzLmdldERpc3BsYXlOdW1iZXIoXG4gICAgICB0aGlzLmN1cnJlbnRPcGVyYW5kXG4gICAgKTtcbiAgICB0aGlzLnByZXZpb3VzT3BlcmFuZFRleHRFbGVtZW50LmlubmVyVGV4dCA9IGAke3RoaXMuZ2V0RGlzcGxheU51bWJlcihcbiAgICAgIHRoaXMucHJldmlvdXNPcGVyYW5kXG4gICAgKX0gJHt0aGlzLm9wZXJhdG9yfWA7XG4gIH1cbn1cblxuY29uc3QgbnVtYmVyQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLW51bWJlcl0nKTtcbmNvbnN0IG9wZXJhdG9yQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLW9wZXJhdG9yXScpO1xuY29uc3QgZGVsZXRlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtZGVsZXRlXScpO1xuY29uc3QgY2xlYXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1jbGVhcl0nKTtcbmNvbnN0IGVxdWFsc0J1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWVxdWFsc10nKTtcbmNvbnN0IHByZXZpb3VzT3BlcmFuZFRleHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1wcmV2aW91cy1vcGVyYW5kXScpO1xuY29uc3QgY3VycmVudE9wZXJhbmRUZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtY3VycmVudC1vcGVyYW5kXScpO1xuXG5jb25zdCBjYWxjdWxhdG9yID0gbmV3IENhbGN1bGF0b3IocHJldmlvdXNPcGVyYW5kVGV4dCwgY3VycmVudE9wZXJhbmRUZXh0KTtcblxubnVtYmVyQnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiB7XG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBjYWxjdWxhdG9yLmFwcGVuZE51bWJlcihidXR0b24uaW5uZXJUZXh0KTtcbiAgICBjYWxjdWxhdG9yLnVwZGF0ZURpc3BsYXkoKTtcbiAgfSk7XG59KTtcblxub3BlcmF0b3JCdXR0b25zLmZvckVhY2goYnV0dG9uID0+IHtcbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIGNhbGN1bGF0b3IuY2hvb3NlT3BlcmF0b3IoYnV0dG9uLmlubmVyVGV4dCk7XG4gICAgY2FsY3VsYXRvci51cGRhdGVEaXNwbGF5KCk7XG4gIH0pO1xufSk7XG5cbmVxdWFsc0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgY2FsY3VsYXRvci5jb21wdXRlKCk7XG4gIGNhbGN1bGF0b3IudXBkYXRlRGlzcGxheSgpO1xufSk7XG5cbmNsZWFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBjYWxjdWxhdG9yLmNsZWFyKCk7XG4gIGNhbGN1bGF0b3IudXBkYXRlRGlzcGxheSgpO1xufSk7XG5cbmRlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgY2FsY3VsYXRvci5kZWxldGUoKTtcbiAgY2FsY3VsYXRvci51cGRhdGVEaXNwbGF5KCk7XG59KTtcblxuY29uc3QgbnVtYmVyQXJyID0gWycxJywgJzInLCAnMycsICc0JywgJzUnLCAnNicsICc3JywgJzgnLCAnOScsICcwJywgJy4nXTtcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbihlKSB7XG4gIGlmIChudW1iZXJBcnIuaW5jbHVkZXMoZS5rZXkpKSB7XG4gICAgY2FsY3VsYXRvci5hcHBlbmROdW1iZXIoZS5rZXkpO1xuICB9IGVsc2UgaWYgKGUua2V5ID09PSAnQmFja3NwYWNlJykge1xuICAgIGNhbGN1bGF0b3IuZGVsZXRlKCk7XG4gIH0gZWxzZSBpZiAoXG4gICAgZS5rZXkgPT09ICctJyB8fFxuICAgIGUua2V5ID09PSAnLycgfHxcbiAgICAoZS5zaGlmdEtleSAmJiAoZS5rZXkgPT09ICcrJyB8fCBlLmtleSA9PT0gJyonIHx8IGUua2V5ID09PSAnJScpKVxuICApIHtcbiAgICBjYWxjdWxhdG9yLmNob29zZU9wZXJhdG9yKGUua2V5KTtcbiAgfSBlbHNlIGlmIChlLmtleSA9PT0gJ0VudGVyJyB8fCBlLmtleSA9PT0gJz0nKSB7XG4gICAgY2FsY3VsYXRvci5jb21wdXRlKCk7XG4gIH1cbiAgY2FsY3VsYXRvci51cGRhdGVEaXNwbGF5KCk7XG4gIGNvbnNvbGUubG9nKGUpO1xufSk7XG5cbmNvbnN0IGNvbG9yVGhlbWVTd2l0Y2ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY29sb3JUaGVtZScpO1xuY29uc3QgY29sb3JUaGVtZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjb2xvclRoZW1lJyk7XG5pZiAoY29sb3JUaGVtZSA9PT0gJ2RhcmsnKSB7XG4gIGNvbG9yVGhlbWVTd2l0Y2guY2hlY2tlZCA9IHRydWU7XG4gIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtdGhlbWUnLCAnZGFyaycpO1xufSBlbHNlIHtcbiAgLy8gaWYgY29sb3JUaGVtZSA9PT0gbnVsbCB3aWxsIGdvZXMgaGVyZVxuICBjb2xvclRoZW1lU3dpdGNoLmNoZWNrZWQgPSBmYWxzZTtcbiAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS10aGVtZScsICdsaWdodCcpO1xufVxuY29sb3JUaGVtZVN3aXRjaC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcbiAgaWYgKHRoaXMuY2hlY2tlZCkge1xuICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtdGhlbWUnLCAnZGFyaycpO1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjb2xvclRoZW1lJywgJ2RhcmsnKTtcbiAgfSBlbHNlIHtcbiAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXRoZW1lJywgJ2xpZ2h0Jyk7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NvbG9yVGhlbWUnLCAnbGlnaHQnKTtcbiAgfVxufSk7XG4iXX0=
